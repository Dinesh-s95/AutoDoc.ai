= Enrollment System Architecture Design

This document provides a comprehensive architecture design for the Enrollment System, focusing on the service architecture, component interaction, infrastructure, and system context.

== 1. Service Architecture Overview

=== High-level System Architecture Diagram

[plantuml, diagram-architecture, png]
----
@startuml
!define SPRING #SpringGreen
!define ENTITY #FFA500
!define SERVICE #ADD8E6
!define CONTROLLER #F4A460

package "Enrollment System" {
  [EnrollmentApplication] << SPRING >>
  [EnrollmentController] << CONTROLLER >>
  [EnrollmentService] << SERVICE >>
  [EnrollmentRepository] << SPRING >>
  [Enrollment] << ENTITY >>
  [UserManagementClient] << SPRING >>
  [UserResponseDTO] << ENTITY >>
}

cloud {
  [User Management System]
}

[EnrollmentApplication] ..> [EnrollmentController]
[EnrollmentController] ..> [EnrollmentService]
[EnrollmentService] ..> [EnrollmentRepository]
[EnrollmentService] ..> [UserManagementClient]
[UserManagementClient] ..> [User Management System]
[EnrollmentRepository] ..> [Enrollment]
@enduml
----

=== External System Connections and Integrations

The Enrollment System integrates with the external User Management System via `UserManagementClient`, which is a Feign client facilitating RESTful communication.

=== Component Interaction Overview

- `EnrollmentController` handles HTTP requests and communicates with `EnrollmentService`.
- `EnrollmentService` performs business logic, interacts with `EnrollmentRepository` for database operations, and uses `UserManagementClient` to fetch user data from external systems.

=== Technology Stack and Frameworks Used

- **Spring Boot**: Framework for creating stand-alone, production-grade Spring based applications.
- **Spring Data JPA**: For database operations.
- **Feign Client**: For declarative REST client creation.
- **H2 Database**: In-memory database for development.
- **JUnit**: For unit testing.

== 2. Component Description

=== EnrollmentApplication

- **Responsibility**: Bootstraps the Spring Boot application.
- **Role**: Main class annotated with `@SpringBootApplication`.

=== EnrollmentController

- **Responsibility**: Handle HTTP requests for enrollment operations.
- **Role**: REST controller that interacts with `EnrollmentService`.
- **Interaction**: Receives HTTP requests and delegates to `EnrollmentService`.

=== EnrollmentService

- **Responsibility**: Contains business logic for enrollment operations.
- **Role**: Service layer that interacts with both `EnrollmentRepository` and `UserManagementClient`.
- **Interaction**: Calls `EnrollmentRepository` for data persistence and `UserManagementClient` for external user data.

=== EnrollmentRepository

- **Responsibility**: Interface for database operations related to `Enrollment` entities.
- **Role**: Spring Data repository, abstracts database interactions.

=== UserManagementClient

- **Responsibility**: Communicate with external User Management System.
- **Role**: Feign client that facilitates external API calls.

=== UserResponseDTO and Enrollment

- **Responsibility**: Serve as data transfer objects and entities.
- **Role**: `UserResponseDTO` is used for transferring user data; `Enrollment` is an entity mapped to the database.

== 3. Infrastructure Architecture

=== Deployment Architecture

The system is containerized using Docker, facilitating easy deployment and scalability. It is deployed on Kubernetes for orchestration.

=== Database Architecture

The system uses an H2 in-memory database for development with Spring Data JPA for ORM. For production, a transition to a more persistent database like PostgreSQL is recommended.

=== Security Architecture

Security is managed via Spring Security, providing robust authentication and authorization capabilities. OAuth2 is used for secure API access.

=== Network Architecture

The system is deployed within a VPC with controlled access to the internet and other services. API Gateway is used to manage and throttle access to the microservices.

== 4. System Context

=== External Systems and Their Interfaces

The system interacts with the User Management System via RESTful services provided by the `UserManagementClient`.

=== Data Flow Between Systems

Data flows from the User Management System into the Enrollment System where it is processed and stored. Responses are sent back to clients via the EnrollmentController.

=== Authentication and Authorization Flows at System Level

OAuth2 tokens are used for securing endpoints. The system verifies tokens with the Authentication Server before granting access to any protected resources.

This document provides a detailed overview of the architecture of the Enrollment System, designed to be scalable, secure, and maintainable.