= Enrollment System Architecture Design

== 1. Service Architecture Overview

=== High-level System Architecture Diagram

[plantuml, diagram-architecture, png]
----
@startuml
package "Enrollment System" {
  [EnrollmentApplication] as App
  [EnrollmentController] as Controller
  [EnrollmentService] as Service
  [EnrollmentRepository] as Repository
  [Enrollment] as Entity

  App --> Controller
  Controller --> Service
  Service --> Repository
  Repository --> Entity
}

package "External Systems" {
  [User Management System] as UserSys
}

[UserManagementClient] --> UserSys

UserSys ..> Service : Uses

@enduml
----

=== External System Connections and Integrations

The Enrollment System integrates with the following external systems:
- **User Management System**: This system is accessed via `UserManagementClient` using Feign for RESTful communication. It manages user-related operations outside the Enrollment System.

=== Component Interaction Overview

- **EnrollmentApplication**: Bootstraps the Spring Boot application.
- **EnrollmentController**: Handles HTTP requests and communicates with the `EnrollmentService`.
- **EnrollmentService**: Contains business logic and interacts with both `EnrollmentRepository` for data persistence and `UserManagementClient` for external user management operations.
- **EnrollmentRepository**: Manages database interactions for `Enrollment` entities.
- **UserManagementClient**: Facilitates communication with the external User Management System.

=== Technology Stack and Frameworks Used

- **Spring Boot**: Framework for creating stand-alone, production-grade Spring based Applications.
- **Spring Data JPA**: Provides repository support for JPA entities.
- **Feign**: A declarative web service client for making HTTP requests to external services.
- **H2 Database**: In-memory database for rapid prototyping and testing.
- **JUnit**: Framework for writing and running repeatable tests.

== 2. Component Description

=== EnrollmentApplication

- **Responsibility**: Initializes and runs the Spring Boot application.
- **Role**: Entry point of the application.
- **Interactions**: Launches `EnrollmentController`.

=== EnrollmentController

- **Responsibility**: Manages incoming HTTP requests and delegates operations to `EnrollmentService`.
- **Role**: REST controller that handles endpoint mappings.
- **Interactions**: Communicates directly with `EnrollmentService`.

=== EnrollmentService

- **Responsibility**: Handles the business logic of the application.
- **Role**: Service layer that processes business rules and interacts with both the repository and external services.
- **Interactions**: Uses `EnrollmentRepository` for data persistence and `UserManagementClient` for external communications.

=== EnrollmentRepository

- **Responsibility**: Manages the persistence layer, specifically for `Enrollment` entities.
- **Role**: Interface that extends Spring Data JPA's JpaRepository.
- **Interactions**: Interacts with the database to fetch and store `Enrollment` data.

=== UserManagementClient

- **Responsibility**: Communicates with the external User Management System.
- **Role**: Feign client that abstracts the complexity of HTTP calls.
- **Interactions**: Used by `EnrollmentService` to fetch or manipulate user data externally.

== 3. Infrastructure Architecture

=== Deployment Architecture

- **Application**: Deployed as a monolithic Spring Boot application.
- **Database**: Uses an embedded H2 database for development and testing.

=== Database Architecture

- **Type**: Relational database.
- **Entities**: `Enrollment` is the main entity, containing fields like `id`, `username`, `role`, and `vin`.

=== Security Architecture

- **Authentication**: Basic authentication for API access.
- **Authorization**: Role-based access control (RBAC) to differentiate user capabilities.

=== Network Architecture

- **Internal**: RESTful API communication within the Spring Boot application.
- **External**: HTTPS for secure communication with external systems.

== 4. System Context

=== External Systems and Their Interfaces

- **User Management System**: Provides user data and management capabilities. Accessed via RESTful services provided by `UserManagementClient`.

=== Data Flow Between Systems

- **Data Retrieval**: `EnrollmentService` retrieves user details from the User Management System.
- **Data Storage**: `EnrollmentService` stores user enrollment details in the `EnrollmentRepository`.

=== Authentication and Authorization Flows at System Level

- **Authentication**: Users authenticate via basic auth against the User Management System.
- **Authorization**: Users are authorized based on their roles which dictate the actions they can perform within the system.

This document provides a comprehensive overview of the Enrollment System architecture, designed for architects and senior developers to understand and contribute effectively to the project.