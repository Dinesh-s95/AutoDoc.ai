= Enrollment System Architecture Design Documentation

:toc:
:toc-placement: auto
:toc-title: Table of Contents
:sectnums:
:icons: font
:source-highlighter: rouge

== Introduction

This document provides a comprehensive architectural overview of the Enrollment System developed using Java Spring Boot. The system is designed to handle user enrollments and integrates with external user management services.

== 1. Service Architecture Overview

=== High-level System Architecture Diagram

[plantuml, "system-architecture", png]
----
@startuml
!define SPRING #SpringGreen
!define ENTITY #FFD700
!define DATABASE #Magenta
!define EXTERNAL #DarkOrange

package "Spring Boot Application" as SpringApp {
  component [EnrollmentApplication] << SPRING >>
  component [EnrollmentController] << SPRING >>
  component [EnrollmentService] << SPRING >>
  database [Enrollment Database] << DATABASE >>
}

node "External Systems" {
  [User Management Service] << EXTERNAL >>
}

SpringApp ..> [User Management Service] : Uses
[EnrollmentController] --> [EnrollmentService] : Calls
[EnrollmentService] --> [Enrollment Database] : Reads/Writes
[EnrollmentService] ..> [User Management Service] : Delegates

@enduml
----

=== External System Connections and Integrations

The system integrates with the following external systems:

- *User Management Service:* Communicates via REST API to manage user data. This integration is facilitated using Spring Cloud OpenFeign.

=== Component Interaction Overview

Components interact primarily through Spring-managed beans:

- `EnrollmentController` receives HTTP requests and delegates operations to `EnrollmentService`.
- `EnrollmentService` handles business logic and interacts with both the local database and external services.

=== Technology Stack and Frameworks Used

- *Spring Boot:* Framework for creating stand-alone, production-grade Spring based applications.
- *Spring Data JPA:* Provides repository support for JPA-based data access layers.
- *Spring Cloud OpenFeign:* Simplifies calling RESTful services.
- *H2 Database:* In-memory database for rapid prototyping and testing.
- *JUnit:* Framework for writing and running repeatable tests.

== 2. Component Description

=== EnrollmentApplication

The entry point of the Spring Boot application, responsible for bootstrapping the application using embedded Tomcat.

=== UserManagementClient

A Feign client that abstracts the communication with the external User Management Service.

=== EnrollmentController

A REST controller that exposes HTTP endpoints for enrollment operations such as nominating a primary user.

=== UserResponseDTO

A Data Transfer Object (DTO) used for transferring user data between processes.

=== Enrollment

A JPA entity representing the enrollment data model.

=== EnrollmentRepository

Spring Data JPA repository for accessing `Enrollment` entities from the database.

=== EnrollmentService

Service layer bean that contains business logic for user enrollment processes. It interacts with `EnrollmentRepository` and `UserManagementClient`.

== 3. Infrastructure Architecture

=== Deployment Architecture

The application is containerized using Docker, allowing for deployment on any system that supports Docker, including Kubernetes clusters for scaling purposes.

=== Database Architecture

The system uses an H2 in-memory database for development, with the flexibility to switch to a more persistent database like PostgreSQL for production environments.

=== Security Architecture

Security is managed via Spring Security, providing robust authentication and authorization capabilities. OAuth2 is used for secure communication with external services.

=== Network Architecture

The application is designed to run within a secured VPC, with strict firewall rules allowing only necessary inbound and outbound traffic.

== 4. System Context

=== External Systems and Their Interfaces

- *User Management Service:* Accessed via RESTful endpoints. Authentication is handled using OAuth2 tokens.

=== Data Flow Between Systems

Data flows from `EnrollmentController` to `EnrollmentService`, and depending on the operation, it might interact with the `EnrollmentRepository` or `User Management Service`.

=== Authentication and Authorization Flows at System Level

Authentication is handled using Spring Security with OAuth2 tokens. Authorization checks are performed before processing any business logic in `EnrollmentService`.

== Conclusion

This document outlines the architecture of the Enrollment System, detailing component interactions, external integrations, and infrastructure setup. This system is built with scalability and security in mind, leveraging modern Java Spring Boot capabilities.