= Enrollment System Architecture Design Document

This document provides a comprehensive overview of the architecture for the Enrollment System, a Java Spring Boot application designed to manage user enrollments. The architecture is described in terms of service architecture, component descriptions, infrastructure, and system context.

== 1. Service Architecture Overview

=== High-level System Architecture Diagram

[plantuml, diagram-architecture, png]
----
@startuml
!define SPRING #SpringGreen
!define ENTITY #MistyRose
!define DATABASE #Violet
!define EXTERNAL #DeepSkyBlue

package "Spring Boot Application" as SBAPP {
  component [EnrollmentApplication] <<SPRING>>
  component [EnrollmentController] <<SPRING>>
  component [EnrollmentService] <<SPRING>>
  component [EnrollmentRepository] <<SPRING>>
  entity [Enrollment] <<ENTITY>>
}

database "Enrollment Database" {
  [Database] <<DATABASE>>
}

[EnrollmentRepository] --> [Database] : reads/writes
[EnrollmentService] --> [EnrollmentRepository] : uses
[EnrollmentController] --> [EnrollmentService] : calls
[EnrollmentApplication] --> [EnrollmentController]

node "External Systems" {
  [User Management System] <<EXTERNAL>>
}

[EnrollmentService] --> [User Management System] : fetches user data

@enduml
----

=== External System Connections and Integrations

The Enrollment System integrates with the following external systems:

- **User Management System**: Communicates via REST API to fetch user data. This integration is facilitated through the `UserManagementClient` which is a Feign client in the Spring Boot application.

=== Component Interaction Overview

Components interact primarily through Spring's dependency injection mechanism. The `EnrollmentController` receives HTTP requests and calls methods in `EnrollmentService`, which in turn interacts with `EnrollmentRepository` to perform database operations. `EnrollmentService` also communicates with external services using `UserManagementClient`.

=== Technology Stack and Frameworks Used

- **Java**: Programming language
- **Spring Boot**: Application framework
- **Spring Data JPA**: Database integration
- **Hibernate**: ORM framework
- **Feign**: Declarative REST client
- **H2 Database**: Development database
- **MySQL**: Production database
- **JUnit**: Testing framework

== 2. Component Description

=== EnrollmentApplication

The entry point of the Spring Boot application, responsible for bootstrapping and launching the application.

=== UserManagementClient

A Feign client that defines the connection and communication details with the external User Management System. It is used by `EnrollmentService` to fetch user data.

=== EnrollmentController

A REST controller that handles HTTP requests related to enrollments. It uses `EnrollmentService` to process business logic.

=== UserResponseDTO

A Data Transfer Object (DTO) used to encapsulate user data as received from the external User Management System.

=== Enrollment

An entity representing the enrollment data in the system. It is managed by Hibernate and persisted in the database through `EnrollmentRepository`.

=== EnrollmentRepository

A Spring Data repository interface that abstracts the data layer, providing CRUD operations on the `Enrollment` entity.

=== EnrollmentService

A service component marked with `@Service` that contains business logic. It interacts with both `EnrollmentRepository` and `UserManagementClient`.

=== EnrollmentApplicationTests

Contains integration and unit tests for the application, ensuring that the system behaves as expected.

== 3. Infrastructure Architecture

=== Deployment Architecture

The application is containerized using Docker, allowing it to be deployed on any Docker-compatible environment, including Kubernetes clusters for better scalability and management.

=== Database Architecture

The application uses MySQL in production with a fallback to H2 database for development. `EnrollmentRepository` interfaces with the database using Spring Data JPA.

=== Security Architecture

The system uses Spring Security for authentication and authorization. HTTPS is enforced for all communications, and JWT tokens are used for securing REST API endpoints.

=== Network Architecture

The application is deployed within a VPC with controlled access to the internet and external systems. Security groups and network ACLs are used to fine-tune the traffic flow.

== 4. System Context

=== External Systems and Their Interfaces

- **User Management System**: Accessed via REST APIs, secured by basic authentication. Provides user data necessary for enrollment processes.

=== Data Flow Between Systems

Data flows from the User Management System to the `EnrollmentService` via `UserManagementClient`. The service layer processes this data and interacts with the database through `EnrollmentRepository`.

=== Authentication and Authorization Flows at System Level

Authentication is managed by Spring Security, which integrates with an identity provider (IdP). Authorization is role-based, controlling access to different parts of the application based on user roles.

This architecture document provides a detailed overview of the system, ensuring that architects and senior developers can understand and contribute effectively to the project.