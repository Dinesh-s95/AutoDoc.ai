= Enrollment System Architecture Design

This document provides a comprehensive architecture design for the Enrollment System developed using Java Spring Boot. The system is designed to manage user enrollments and integrates with external user management services.

== Service Architecture Overview

=== High-level System Architecture Diagram

[plantuml, diagram-arch, png]
....
@startuml
package "Enrollment System" {
  [EnrollmentApplication] as App
  [EnrollmentController] as Controller
  [EnrollmentService] as Service
  [EnrollmentRepository] as Repository
  [Enrollment] as Entity

  App --> Controller
  Controller --> Service
  Service --> Repository
  Repository --> Entity
}

package "External Systems" {
  [UserManagementClient] as UserClient
}

Service --> UserClient

@enduml
....

=== External System Connections and Integrations

The Enrollment System integrates with an external user management service through the `UserManagementClient`, which is implemented using Feign for REST client capabilities.

=== Component Interaction Overview

The `EnrollmentController` receives HTTP requests and interacts with the `EnrollmentService` to process business logic. The `EnrollmentService` uses `EnrollmentRepository` for data persistence and interacts with `UserManagementClient` to fetch and validate user data from external services.

=== Technology Stack and Frameworks Used

* Java 11
* Spring Boot 2.5.x
* Spring Data JPA
* Spring Cloud OpenFeign
* H2 Database for development
* PostgreSQL for production
* Maven for dependency management

== Component Description

=== EnrollmentApplication

* **Responsibility**: Bootstraps the Spring Boot application.
* **Role**: Entry point of the application.
* **Interaction**: Initiates the `EnrollmentController`.

=== EnrollmentController

* **Responsibility**: Handles incoming HTTP requests.
* **Role**: REST controller to manage enrollment operations.
* **Interaction**: Uses `EnrollmentService` to perform business operations.

=== EnrollmentService

* **Responsibility**: Contains business logic for enrollment operations.
* **Role**: Service layer to abstract business logic from web layer.
* **Interaction**: Communicates with `EnrollmentRepository` for database operations and `UserManagementClient` for external user validations.

=== EnrollmentRepository

* **Responsibility**: Manages database interactions.
* **Role**: Repository layer using Spring Data JPA.
* **Interaction**: Interacts with the database to perform CRUD operations on `Enrollment` entities.

=== UserManagementClient

* **Responsibility**: Interacts with external user management services.
* **Role**: External service client created with Feign.
* **Interaction**: Called by `EnrollmentService` for external user data.

== Infrastructure Architecture

=== Deployment Architecture

* **Description**: The application is containerized using Docker and deployed on Kubernetes clusters for scalability and management.
* **Components**: Docker, Kubernetes.

=== Database Architecture

* **Description**: Uses PostgreSQL in production with a fallback to H2 database in development environments.
* **Components**: Spring Data JPA for ORM, Flyway for migrations.

=== Security Architecture

* **Description**: Implements OAuth2 for secure access, with JWT tokens for stateless authentication.
* **Components**: Spring Security, Auth0.

=== Network Architecture

* **Description**: Designed to operate within a VPC with restricted access to ensure secure communication channels.
* **Components**: AWS VPC, Security Groups, IAM Roles.

== System Context

=== External Systems and Their Interfaces

* **User Management Service**: Provides user validation and data through REST API consumed by `UserManagementClient`.

=== Data Flow Between Systems

* **Flow**: User data flows from the User Management Service into the Enrollment System where it is processed and stored.

=== Authentication and Authorization Flows at System Level

* **Flow**: Users authenticate via OAuth2, receiving JWT tokens to make authorized requests to the system.

This architecture document provides a detailed overview of the Enrollment System, ensuring clarity in design and implementation for all stakeholders involved.