= User Management API Documentation

== Introduction

The User Management API provides a set of RESTful services for managing users and their vehicle assignments within a mobility platform. This API allows for operations such as user onboarding and vehicle assignment to users.

=== Authentication Requirements

The API uses OAuth 2.0 for securing endpoints. Clients must obtain an access token from the Identity Provider and include it in the Authorization header as a Bearer token.

=== Base URL and Versioning

The base URL for all API endpoints is `https://api.example.com/v1`.

=== How to Use This Specification

This document is structured according to the OpenAPI 3.0 specification. It can be imported into tools like Swagger UI, Postman, or Insomnia for interactive exploration and testing of the API endpoints.

== OpenAPI 3.0 YAML Specification 

[source,yaml]
----
openapi: 3.0.0
info:
  title: User Management API
  version: 1.0.0
  description: API for managing users and their vehicle assignments.
servers:
  - url: https://api.example.com/v1
    description: Production server

paths:
  /users/onboard:
    post:
      summary: Onboard a new user
      operationId: onboardUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserOnboardingRequest'
      responses:
        '201':
          description: User onboarded successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /users/assign-vehicle:
    post:
      summary: Assign a vehicle to a user
      operationId: assignVehicle
      parameters:
        - name: username
          in: query
          required: true
          schema:
            type: string
        - name: vin
          in: query
          required: true
          schema:
            type: string
        - name: brand
          in: query
          required: true
          schema:
            type: string
        - name: country
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Vehicle assigned successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VehicleAssignmentResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

components:
  schemas:
    UserOnboardingRequest:
      type: object
      properties:
        username:
          type: string
        password:
          type: string
    UserResponse:
      type: object
      properties:
        id:
          type: string
        username:
          type: string
        status:
          type: string
    VehicleAssignmentResponse:
      type: object
      properties:
        username:
          type: string
        vin:
          type: string
        status:
          type: string
    Error:
      type: object
      properties:
        code:
          type: integer
        message:
          type: string
security:
  - bearerAuth: []

securitySchemes:
  bearerAuth:
    type: http
    scheme: bearer
    bearerFormat: JWT
----

== API Documentation

=== Endpoint Descriptions and Usage Examples

==== Onboard User

Endpoint to onboard a new user. Requires username and password.

Example Request:
[source,json]
----
POST /users/onboard
{
  "username": "newuser",
  "password": "password123"
}
----

Example Response:
[source,json]
----
{
  "id": "1",
  "username": "newuser",
  "status": "active"
}
----

==== Assign Vehicle to User

Endpoint to assign a vehicle to an existing user. Requires username, vehicle identification number (VIN), brand, and country.

Example Request:
[source,json]
----
POST /users/assign-vehicle?username=user1&vin=12345&brand=Toyota&country=USA
----

Example Response:
[source,json]
----
{
  "username": "user1",
  "vin": "12345",
  "status": "assigned"
}
----

=== Authentication Flows

Clients must authenticate using OAuth 2.0. Obtain an access token from the Identity Provider and include it as a Bearer token in the Authorization header.

=== Common Error Codes and Their Meanings

- `400` - Bad request: The request was unacceptable, often due to missing a required parameter.
- `401` - Unauthorized: No valid authentication credentials for the target resource.
- `404` - Not Found: The requested resource does not exist.
- `500` - Internal Server Error: An error occurred on the server side.

=== Rate Limiting Information

The API is subject to rate limiting to ensure fair usage. Clients are limited to 100 requests per minute. Exceeding this limit will result in a `429 Too Many Requests` response.