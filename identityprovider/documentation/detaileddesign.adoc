= Detailed Design Documentation

== Class-by-Class Analysis

=== IdentityproviderApplication

Purpose:
- Main class for Spring Boot application.

Methods:
- `public static void main(String[] args)`: Entry point for the application.

Annotations:
- `@SpringBootApplication`: Indicates this class is the main Spring Boot application class.

Design Patterns:
- N/A

=== JwtAuthFilter

Purpose:
- Custom filter for JWT authentication.

Methods:
- `protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException`: Handles JWT authentication logic.

Annotations:
- `@Autowired`, `@Component`, `@Override`, `@Slf4j`: Spring annotations for dependency injection and logging.

Design Patterns:
- N/A

=== SecurityConfig

Purpose:
- Configuration class for security settings.

Methods:
- `public AuthenticationManager authenticationManager(final AuthenticationConfiguration authConfig) throws Exception`: Configures authentication manager.
- `public AuthenticationProvider authenticationProvider()`: Configures authentication provider.
- `public SecurityFilterChain securityFilterChain(final HttpSecurity http) throws Exception`: Configures security filter chain.

Annotations:
- `@Autowired`, `@Bean`, `@Configuration`, `@EnableWebSecurity`: Spring annotations for configuration.

Design Patterns:
- N/A

=== UserController

Purpose:
- Controller class for user-related operations.

Methods:
- `public ResponseEntity<Object> login(@RequestBody final Users user)`: Handles user login.
- `public String greet()`: Returns a greeting message.
- `public String greet2()`: Returns another greeting message.
- `public Users registerUser(@RequestBody final Users user)`: Registers a new user.

Annotations:
- `@Autowired`, `@GetMapping`, `@PostMapping`, `@RequestBody`, `@RequestMapping`, `@RestController`: Spring annotations for REST API endpoints.

Design Patterns:
- N/A

=== AuthRequest

Purpose:
- Request DTO for authentication.

Fields:
- `password : String`
- `username : String`

Annotations:
- `@Data`: Lombok annotation for generating getters, setters, and other boilerplate code.

Design Patterns:
- N/A

=== AuthResponse

Purpose:
- Response DTO for authentication.

Design Patterns:
- N/A

=== UserPrincipal

Purpose:
- Custom principal class for user details.

Methods:
- Various methods for user details.

Fields:
- `user : final Users`

Annotations:
- `@Override`: Indicates overridden methods.

Design Patterns:
- N/A

=== Users

Purpose:
- Entity class representing users.

Methods:
- `public String getPassword()`
- `public String getUsername()`

Fields:
- `password : String`
- `userId : Long`
- `username : String`

Annotations:
- `@Data`, `@Entity`, `@GeneratedValue`, `@Getter`, `@Id`, `@Setter`: Annotations for entity mapping and Lombok functionality.

Design Patterns:
- N/A

=== UserRepository

Purpose:
- Repository interface for user entity.

Annotations:
- `@Repository`: Spring Data annotation for repository.

Design Patterns:
- N/A

=== JWTService

Purpose:
- Service class for JWT operations.

Methods:
- `public String extractUsername(String token)`: Extracts username from JWT token.
- `public String generateToken(final String username)`: Generates JWT token.
- `public boolean validateToken(String token)`: Validates JWT token.

Fields:
- `secretKey : final Key`

Annotations:
- `@Service`, `@Slf4j`: Spring annotations for service classes.

Design Patterns:
- N/A

=== UserService

Purpose:
- Service class for user-related operations.

Methods:
- `public UserDetails loadUserByUsername(final String username) throws UsernameNotFoundException`: Loads user details by username.
- `public Users register(final Users user)`: Registers a new user.

Fields:
- `encoder : BCryptPasswordEncoder`
- `userRepository : UserRepository`

Annotations:
- `@Autowired`, `@Override`, `@Service`: Spring annotations for service classes.

Design Patterns:
- N/A

=== IdentityproviderApplicationTests

Purpose:
- Test class for the Spring Boot application.

Annotations:
- `@SpringBootTest`, `@Test`: Spring annotations for testing.

Design Patterns:
- N/A

== Runtime View Diagrams

[plantuml, runtime-view]
----
title User Registration Flow
UserController -> UserService: register
UserService -> UserRepository: save
----

[plantuml, runtime-view]
----
title Authentication/Login Flow
UserController -> AuthenticationManager: authenticate
AuthenticationManager -> AuthenticationProvider: authenticate
AuthenticationProvider -> UserService: loadUserByUsername
UserService -> UserRepository: findByUsername
----

[plantuml, runtime-view]
----
title JWT Token Validation Flow
JwtAuthFilter -> JWTService: validateToken
----

[plantuml, runtime-view]
----
title Key Business Process Flow
// Add your custom business process flow here
----

[plantuml, runtime-view]
----
title Exception Handling Flow
// Add your exception handling flow here
----

== Entity Relationship Diagram

[plantuml, erd]
----
entity Users {
  Long userId
  String username
  String password
}

Users ||--o UserRepository : Contains

entity Users {
  Long userId
  String username
  String password
}
----

== Detailed Component Interactions

- Controller-Service-Repository interactions: Controllers interact with services, which in turn interact with repositories for data operations.
- Data flow through layers: Data flows from controllers to services and then to repositories for CRUD operations.
- Exception propagation: Exceptions are handled at different layers and propagated up the stack as needed.
- Transaction boundaries: Transactions are managed at the service layer to ensure data consistency.

This detailed design documentation provides insights into the class structure, runtime flows, entity relationships, and component interactions of the Java Spring Boot application. Developers can refer to this document for a comprehensive understanding of the implementation design.