= Identity Provider API Documentation

== Introduction

The Identity Provider API offers a set of RESTful endpoints for user authentication and registration. This API provides the necessary operations to manage user authentication states and register new users.

=== Authentication Requirements

The API uses JWT (JSON Web Tokens) for handling authentication. Clients must authenticate by providing a valid JWT in the `Authorization` header of their HTTP requests.

=== Base URL and Versioning

The base URL for all API endpoints is `https://api.example.com/v1`. This API is currently at version 1.

=== How to Use This Specification

This document is structured according to the OpenAPI 3.0 specification. It can be imported into tools like Swagger UI, Postman, or Insomnia for interaction with the API endpoints. The document includes detailed descriptions of each endpoint, including required parameters, request bodies, and response formats.

== OpenAPI 3.0 YAML Specification

[source,yaml]
----
openapi: 3.0.0
info:
  title: Identity Provider API
  version: 1.0.0
  description: API for managing user authentication and registration.
servers:
  - url: https://api.example.com/v1
    description: Production server

paths:
  /login:
    post:
      summary: Authenticate a user and return a JWT.
      operationId: loginUser
      tags:
        - User
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthRequest'
      responses:
        '200':
          description: Authentication successful.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '401':
          description: Authentication failed.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /register:
    post:
      summary: Register a new user.
      operationId: registerUser
      tags:
        - User
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Users'
      responses:
        '201':
          description: User registered successfully.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Users'
        '400':
          description: Error in registration data.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

components:
  schemas:
    AuthRequest:
      type: object
      properties:
        username:
          type: string
        password:
          type: string
      required:
        - username
        - password
    AuthResponse:
      type: object
      properties:
        token:
          type: string
    Users:
      type: object
      properties:
        userId:
          type: integer
          format: int64
        username:
          type: string
        password:
          type: string
      required:
        - username
        - password
    Error:
      type: object
      properties:
        message:
          type: string
        code:
          type: integer
      required:
        - message
        - code
security:
  - bearerAuth: []
securitySchemes:
  bearerAuth:
    type: http
    scheme: bearer
    bearerFormat: JWT
----

== API Documentation

=== Endpoint Descriptions and Usage Examples

==== Login

Endpoint to authenticate a user and return a JWT.

===== Example Request

[source,json]
----
{
  "username": "john.doe",
  "password": "examplepassword"
}
----

===== Example Response

[source,json]
----
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJqb2huLmRvZSIsImV4cCI6MTYxOTc3MzIwMH0.QdQ69vHDjy9fTGl4kH8ZPprdb1VcEUiVgJt7auHlG4I"
}
----

==== Register

Endpoint to register a new user.

===== Example Request

[source,json]
----
{
  "username": "new.user",
  "password": "newpassword"
}
----

===== Example Response

[source,json]
----
{
  "userId": 101,
  "username": "new.user"
}
----

=== Authentication Flows

Clients must authenticate by including a valid JWT in the `Authorization` header of their requests. The token can be obtained by making a successful login request.

=== Common Error Codes and Their Meanings

- `401 Unauthorized`: Authentication failed due to invalid credentials.
- `400 Bad Request`: The request was unacceptable, often due to missing a required parameter or invalid data.

=== Rate Limiting Information

Currently, there are no rate limits enforced on the API. However, future versions may include rate limiting to prevent abuse.