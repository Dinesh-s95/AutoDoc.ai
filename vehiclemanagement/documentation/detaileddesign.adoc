= Detailed Design Documentation

== Class-by-Class Analysis

=== Vehicle

Purpose:
- The `Vehicle` class represents a vehicle entity in the system.
- It contains attributes such as brand, country, device, model, SOP (Start of Production), and VIN (Vehicle Identification Number).

Methods:
- `getSop()`: Returns the Start of Production date.
- `getBrand()`: Returns the brand of the vehicle.
- `getCountry()`: Returns the country of the vehicle.
- `getDevice()`: Returns the device of the vehicle.
- `getModel()`: Returns the model of the vehicle.
- `getVin()`: Returns the Vehicle Identification Number.
- `setBrand(String brand)`: Sets the brand of the vehicle.
- `setCountry(String country)`: Sets the country of the vehicle.
- `setDevice(String device)`: Sets the device of the vehicle.
- `setModel(String model)`: Sets the model of the vehicle.
- `setSop(LocalDate sop)`: Sets the Start of Production date.
- `setVin(String vin)`: Sets the Vehicle Identification Number.

Annotations:
- `@Entity`: Indicates that this class is an entity and is mapped to a database table.
- `@Id`: Specifies the primary key of the entity.
- `@NotBlank`: Validates that the annotated field is not null or empty.
- `@NotNull`: Validates that the annotated field is not null.
- `@Table`: Specifies the table name for the entity in the database.

Design Patterns:
- This class follows the Entity design pattern for representing database entities.

=== VehiclemanagementApplication

Purpose:
- The `VehiclemanagementApplication` class serves as the entry point for the Spring Boot application.

Methods:
- `main(String[] args)`: The main method that starts the Spring Boot application.

Annotations:
- `@SpringBootApplication`: Indicates that this class is the main configuration class for the Spring Boot application.

=== VehicleController

Purpose:
- The `VehicleController` class handles HTTP requests related to vehicles.

Methods:
- `registerVehicle(Vehicle vehicle)`: Registers a new vehicle in the system.
- `verifyRegistration(String vin, String brand, String country)`: Verifies the registration details of a vehicle.

Annotations:
- `@Autowired`: Injects dependencies into the controller.
- `@GetMapping`: Handles HTTP GET requests.
- `@PostMapping`: Handles HTTP POST requests.
- `@RequestBody`: Binds the HTTP request body to a method parameter.
- `@RequestMapping`: Maps HTTP requests to handler methods.
- `@RequestParam`: Binds a method parameter to a web request parameter.
- `@RestController`: Indicates that this class is a REST controller.
- `@Validated`: Validates method arguments.

Fields:
- `vehicleRepository`: Instance of `VehicleRepository` for interacting with vehicle data.

Design Patterns:
- This class follows the Controller design pattern for handling HTTP requests.

=== VehicleRepository

Purpose:
- The `VehicleRepository` class provides methods for interacting with the database to manage vehicle entities.

Annotations:
- `@Repository`: Indicates that this class is a repository component for database operations.

=== VehiclemanagementApplicationTests

Purpose:
- The `VehiclemanagementApplicationTests` class contains test cases for the Spring Boot application.

Annotations:
- `@SpringBootTest`: Indicates that the tests should load the Spring application context.
- `@Test`: Marks a method as a test method.

== Runtime View Diagrams

[plantuml, runtime-view]
----
title User Registration Flow
VehicleController -> VehicleRepository: Save Vehicle
VehicleRepository --> VehicleController: Vehicle Saved
----

[plantuml, runtime-view]
----
title Authentication/Login Flow
User -> VehicleController: Login Request
VehicleController -> AuthenticationProvider: Authenticate User
AuthenticationProvider --> VehicleController: Authentication Result
----

[plantuml, runtime-view]
----
title JWT Token Validation Flow
User -> VehicleController: Request with JWT Token
VehicleController -> JwtTokenValidator: Validate Token
JwtTokenValidator --> VehicleController: Token Validation Result
----

[plantuml, runtime-view]
----
title Key Business Process Flow
User -> VehicleController: Request
VehicleController -> Service: Process Request
Service -> Repository: Retrieve Data
Repository --> Service: Data Retrieved
Service --> VehicleController: Response
----

[plantuml, runtime-view]
----
title Exception Handling Flow
User -> VehicleController: Request
VehicleController -> Service: Process Request
Service -> ExceptionHandler: Handle Exception
ExceptionHandler --> VehicleController: Exception Response
----

== Entity Relationship Diagram

[plantuml, er-diagram]
----
entity Vehicle {
  + Long id
  --
  + String brand
  + String country
  + String device
  + String model
  + LocalDate sop
  + String vin
}

Vehicle ||--o VehicleRepository : CRUD
----

== Detailed Component Interactions

- Controller-Service-Repository interactions:
  - The `VehicleController` interacts with the `VehicleService`, which in turn interacts with the `VehicleRepository` for CRUD operations.
- Data flow through layers:
  - HTTP requests flow from the controller to the service layer for processing and then to the repository for data access.
- Exception propagation:
  - Exceptions thrown in the service layer are handled by the exception handler in the controller layer.
- Transaction boundaries:
  - Transactions are managed by Spring's declarative transaction management, ensuring atomicity and consistency.

This document provides a detailed overview of the design and interactions within the Java Spring Boot application.